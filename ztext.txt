def write_observations(observations: List[Observation], bucket: str):
    with write_client.write_api(write_options=SYNCHRONOUS) as write_api:
        for obs in observations:
            point = (
                Point("observations")
                .tag("node_source", obs.node_source)
                .tag("node_source_id", obs.node_source_id)
                .tag("sensor_source", obs.sensor_source)
                .tag("sensor_source_id", obs.sensor_source_id)
                .tag("parameter", obs.parameter)
                .tag("unit", obs.unit)
                .field("value", float(obs.value))
                .field("latitude", float(obs.latitude))
                .field("longitude", float(obs.longitude))
                .field(
                    "quality_codes",
                    "[" + ",".join(str(q) for q in obs.quality_codes) + "]"
                )
                .time(obs.time, WritePrecision.NS)
            )

            write_api.write(bucket=bucket, record=point)
